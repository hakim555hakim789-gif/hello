<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Øª Ø³ÛŒÙ†Ù…Ø§ Ø§ÛŒØ±Ø§Ù†</title>
    <style>
        body {
            font-family: 'Vazirmatn', 'Tahoma', sans-serif;
            padding: 2rem;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-button {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            margin: 0.5rem;
        }
        .test-button:hover {
            background: #c0392b;
        }
        .result {
            margin-top: 1rem;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 4px;
            border-left: 4px solid #28a745;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª ØªØ³Øª Ø³ÛŒÙ†Ù…Ø§ Ø§ÛŒØ±Ø§Ù†</h1>
    
    <div class="test-section">
        <h2>1ï¸âƒ£ ØªØ³Øª Ù„ÙˆØ¯ Ú©Ø±Ø¯Ù† Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§</h2>
        <button class="test-button" onclick="testDataLoading()">ØªØ³Øª Ù„ÙˆØ¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§</button>
        <div id="dataResult"></div>
    </div>
    
    <div class="test-section">
        <h2>2ï¸âƒ£ ØªØ³Øª Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª</h2>
        <button class="test-button" onclick="testAuth()">ØªØ³Øª Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª</button>
        <div id="authResult"></div>
    </div>
    
    <div class="test-section">
        <h2>3ï¸âƒ£ ØªØ³Øª ÙÛŒÙ„ØªØ± ÙÛŒÙ„Ù…â€ŒÙ‡Ø§</h2>
        <button class="test-button" onclick="testMovieFiltering()">ØªØ³Øª ÙÛŒÙ„ØªØ± ÙÛŒÙ„Ù…â€ŒÙ‡Ø§</button>
        <div id="filterResult"></div>
    </div>
    
    <div class="test-section">
        <h2>4ï¸âƒ£ ØªØ³Øª Ø§Ù†ØªØ®Ø§Ø¨ Ø³ÛŒÙ†Ù…Ø§</h2>
        <button class="test-button" onclick="testCinemaSelection()">ØªØ³Øª Ø§Ù†ØªØ®Ø§Ø¨ Ø³ÛŒÙ†Ù…Ø§</button>
        <div id="cinemaResult"></div>
    </div>
    
    <div class="test-section">
        <h2>5ï¸âƒ£ ØªØ³Øª Ø±Ø²Ø±Ùˆ ØµÙ†Ø¯Ù„ÛŒ</h2>
        <button class="test-button" onclick="testSeatBooking()">ØªØ³Øª Ø±Ø²Ø±Ùˆ ØµÙ†Ø¯Ù„ÛŒ</button>
        <div id="seatResult"></div>
    </div>
    
    <script src="js/main.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/seats.js"></script>
    
    <script>
        // Test 1: Data Loading
        async function testDataLoading() {
            const result = document.getElementById('dataResult');
            result.innerHTML = '<p>Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª...</p>';
            
            try {
                // Check if data is loaded
                const movies = JSON.parse(localStorage.getItem('movies') || '[]');
                const cinemas = JSON.parse(localStorage.getItem('cinemas') || '[]');
                const users = JSON.parse(localStorage.getItem('users') || '[]');
                const schedules = JSON.parse(localStorage.getItem('schedules') || '[]');
                
                result.innerHTML = `
                    <div class="result">
                        <h4>âœ… Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ù„ÙˆØ¯ Ø´Ø¯Ù†Ø¯:</h4>
                        <p>ğŸ¬ ÙÛŒÙ„Ù…â€ŒÙ‡Ø§: ${movies.length} Ø¹Ø¯Ø¯</p>
                        <p>ğŸ¢ Ø³ÛŒÙ†Ù…Ø§Ù‡Ø§: ${cinemas.length} Ø¹Ø¯Ø¯</p>
                        <p>ğŸ‘¥ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†: ${users.length} Ø¹Ø¯Ø¯</p>
                        <p>ğŸ“… Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒÙ‡Ø§: ${schedules.length} Ø¹Ø¯Ø¯</p>
                    </div>
                `;
            } catch (error) {
                result.innerHTML = `
                    <div class="result" style="border-left-color: #dc3545;">
                        <h4>âŒ Ø®Ø·Ø§ Ø¯Ø± Ù„ÙˆØ¯ Ú©Ø±Ø¯Ù† Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§:</h4>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        }
        
        // Test 2: Authentication
        function testAuth() {
            const result = document.getElementById('authResult');
            result.innerHTML = '<p>Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª...</p>';
            
            try {
                const users = JSON.parse(localStorage.getItem('users') || '[]');
                const admin = users.find(u => u.username === 'admin');
                const manager = users.find(u => u.role === 'cinema_manager');
                
                if (admin && manager) {
                    result.innerHTML = `
                        <div class="result">
                            <h4>âœ… Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ø¯Ø±Ø³Øª Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯:</h4>
                            <p>ğŸ‘¨â€ğŸ’¼ Ø§Ø¯Ù…ÛŒÙ†: ${admin.username} (${admin.role})</p>
                            <p>ğŸ­ Ù…Ø¯ÛŒØ± Ø³ÛŒÙ†Ù…Ø§: ${manager.username} (${manager.role})</p>
                        </div>
                    `;
                } else {
                    result.innerHTML = `
                        <div class="result" style="border-left-color: #dc3545;">
                            <h4>âŒ Ù…Ø´Ú©Ù„ Ø¯Ø± Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª:</h4>
                            <p>Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ù¾ÛŒØ´â€ŒÙØ±Ø¶ ÛŒØ§ÙØª Ù†Ø´Ø¯Ù†Ø¯</p>
                        </div>
                    `;
                }
            } catch (error) {
                result.innerHTML = `
                    <div class="result" style="border-left-color: #dc3545;">
                        <h4>âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª:</h4>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        }
        
        // Test 3: Movie Filtering
        function testMovieFiltering() {
            const result = document.getElementById('filterResult');
            result.innerHTML = '<p>Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª...</p>';
            
            try {
                const movies = JSON.parse(localStorage.getItem('movies') || '[]');
                const schedules = JSON.parse(localStorage.getItem('schedules') || '[]');
                const cinemas = JSON.parse(localStorage.getItem('cinemas') || '[]');
                
                // Test cinema 1 movies
                const cinema1Schedules = schedules.filter(s => s.cinemaId === 1);
                const cinema1Movies = movies.filter(m => 
                    cinema1Schedules.some(s => s.movieId === m.id)
                );
                
                result.innerHTML = `
                    <div class="result">
                        <h4>âœ… ÙÛŒÙ„ØªØ± Ú©Ø±Ø¯Ù† ÙÛŒÙ„Ù…â€ŒÙ‡Ø§ Ø¯Ø±Ø³Øª Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯:</h4>
                        <p>ğŸ¬ Ø³ÛŒÙ†Ù…Ø§ 1: ${cinema1Movies.length} ÙÛŒÙ„Ù…</p>
                        <p>ğŸ“… Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø³ÛŒÙ†Ù…Ø§ 1: ${cinema1Schedules.length} Ø¹Ø¯Ø¯</p>
                        <p>ğŸ­ ÙÛŒÙ„Ù…â€ŒÙ‡Ø§ÛŒ Ø³ÛŒÙ†Ù…Ø§ 1: ${cinema1Movies.map(m => m.title).join(', ')}</p>
                    </div>
                `;
            } catch (error) {
                result.innerHTML = `
                    <div class="result" style="border-left-color: #dc3545;">
                        <h4>âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª ÙÛŒÙ„ØªØ± ÙÛŒÙ„Ù…â€ŒÙ‡Ø§:</h4>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        }
        
        // Test 4: Cinema Selection
        function testCinemaSelection() {
            const result = document.getElementById('cinemaResult');
            result.innerHTML = '<p>Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª...</p>';
            
            try {
                const cinemas = JSON.parse(localStorage.getItem('cinemas') || '[]');
                const schedules = JSON.parse(localStorage.getItem('schedules') || '[]');
                
                let cinemaInfo = '';
                cinemas.forEach(cinema => {
                    const cinemaSchedules = schedules.filter(s => s.cinemaId === cinema.id);
                    cinemaInfo += `<p>ğŸ¢ ${cinema.name}: ${cinemaSchedules.length} Ø¨Ø±Ù†Ø§Ù…Ù‡</p>`;
                });
                
                result.innerHTML = `
                    <div class="result">
                        <h4>âœ… Ø§Ù†ØªØ®Ø§Ø¨ Ø³ÛŒÙ†Ù…Ø§ Ø¯Ø±Ø³Øª Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯:</h4>
                        ${cinemaInfo}
                    </div>
                `;
            } catch (error) {
                result.innerHTML = `
                    <div class="result" style="border-left-color: #dc3545;">
                        <h4>âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª Ø§Ù†ØªØ®Ø§Ø¨ Ø³ÛŒÙ†Ù…Ø§:</h4>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        }
        
        // Test 5: Seat Booking
        function testSeatBooking() {
            const result = document.getElementById('seatResult');
            result.innerHTML = '<p>Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª...</p>';
            
            try {
                const movies = JSON.parse(localStorage.getItem('movies') || '[]');
                const cinemas = JSON.parse(localStorage.getItem('cinemas') || '[]');
                
                if (movies.length > 0 && cinemas.length > 0) {
                    result.innerHTML = `
                        <div class="result">
                            <h4>âœ… Ø±Ø²Ø±Ùˆ ØµÙ†Ø¯Ù„ÛŒ Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª:</h4>
                            <p>ğŸ¬ ÙÛŒÙ„Ù… Ù†Ù…ÙˆÙ†Ù‡: ${movies[0].title}</p>
                            <p>ğŸ¢ Ø³ÛŒÙ†Ù…Ø§ Ù†Ù…ÙˆÙ†Ù‡: ${cinemas[0].name}</p>
                            <p>ğŸ’º Ø¸Ø±ÙÛŒØª: ${cinemas[0].capacity} ØµÙ†Ø¯Ù„ÛŒ</p>
                            <p>ğŸ’° Ù‚ÛŒÙ…Øª: ${movies[0].price} ØªÙˆÙ…Ø§Ù†</p>
                        </div>
                    `;
                } else {
                    result.innerHTML = `
                        <div class="result" style="border-left-color: #dc3545;">
                            <h4>âŒ Ù…Ø´Ú©Ù„ Ø¯Ø± Ø±Ø²Ø±Ùˆ ØµÙ†Ø¯Ù„ÛŒ:</h4>
                            <p>Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù„Ø§Ø²Ù… Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª</p>
                        </div>
                    `;
                }
            } catch (error) {
                result.innerHTML = `
                    <div class="result" style="border-left-color: #dc3545;">
                        <h4>âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª Ø±Ø²Ø±Ùˆ ØµÙ†Ø¯Ù„ÛŒ:</h4>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        }
        
        // Auto-run tests when page loads
        window.addEventListener('load', () => {
            setTimeout(() => {
                testDataLoading();
                testAuth();
                testMovieFiltering();
                testCinemaSelection();
                testSeatBooking();
            }, 1000);
        });
    </script>
</body>
</html>